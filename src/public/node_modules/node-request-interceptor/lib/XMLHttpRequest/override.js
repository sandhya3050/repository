"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var createXMLHttpRequestOverride_1 = require("./XMLHttpRequest/createXMLHttpRequestOverride");
var debug = require('debug')('XHR');
var original = {
    XMLHttpRequest: 
    // Although executed in node, certain processes emulate the DOM-like environment
    // (i.e. `js-dom` in Jest). The `window` object would be avilable in such environments.
    typeof window === 'undefined' ? undefined : window.XMLHttpRequest,
};
/**
 * Conditionally overrides the `XMLHttpRequest` class using a given request middleware.
 */
exports.overrideXhrModule = function (middleware) {
    if (original.XMLHttpRequest) {
        debug('patching "XMLHttpRequest" module...');
        var XMLHttpRequestOverride = createXMLHttpRequestOverride_1.createXMLHttpRequestOverride(middleware, original.XMLHttpRequest);
        // @ts-ignore
        window.XMLHttpRequest = XMLHttpRequestOverride;
    }
    return function () {
        if (original.XMLHttpRequest) {
            debug('restoring patches...');
            window.XMLHttpRequest = original.XMLHttpRequest;
        }
    };
};
